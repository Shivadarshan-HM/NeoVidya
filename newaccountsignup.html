<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NeoVidya ‚Äì Create Account</title>
  <meta name="theme-color" content="#0F4C81" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
  <style>
    /* ------------------------------------------------------
       THEME VARIABLES
       ------------------------------------------------------ */
    :root{
      /* Brand */
      --nv-blue-900:#0F4C81; --nv-blue-700:#0B3A63; --nv-blue-600:#2D9CDB;
      --nv-yellow-500:#F4B400; --nv-green-600:#27AE60; --nv-coral-500:#FF6B6B;
      /* Radii & shadows */
      --radius-xl:18px; --radius-2xl:28px; --shadow-lg:0 12px 32px rgba(7,26,46,.35);

      /* Dark theme defaults */
      --bg: #020817;            /* page background */
      --fg: #E9F2FF;            /* base text */
      --muted-fg: #BFD5F7;      /* subtle text */
      --panel: rgba(255,255,255,.06);
      --panel-border: rgba(255,255,255,.12);
      --input-bg: rgba(255,255,255,.06);
      --input-border: rgba(255,255,255,.16);
      --tab-bg: rgba(255,255,255,.06);
      --tab-border: rgba(255,255,255,.16);
      --subtitle-fg:#D7E8FF;
    }
    body.theme-light{
      --bg: #EAF5FF;            /* light page background */
      --fg: #0C1220;            /* dark text on light */
      --muted-fg: #324666;      /* subtle text */
      --panel: #ffffffd9;
      --panel-border: rgba(15,53,90,.12);
      --input-bg: #f5f8ff;
      --input-border: #d7e7ff;
      --tab-bg: #f2f6ff;
      --tab-border: #dbe6ff;
      --subtitle-fg:#18324e;
    }

    /* Global reset / base */
    *, *::before, *::after{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--fg);
      background:var(--bg);
      font-family:"Nunito", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      line-height:1.5;
      transition:background .3s ease, color .2s ease;
      overflow-x:hidden; /* allow page to scroll vertically */
    }

    /* Sky/backdrop */
    .sky{position:fixed;inset:0;z-index:-2}
    .sun{position:absolute;width:220px;height:220px;border-radius:50%;right:7vw;top:7vh;background:radial-gradient(circle at 35% 35%,#fff9d6 0%,#ffe36b 40%,#ffd34a 60%,#ffd34a00 72%);box-shadow:0 0 80px 30px #ffd34a88,0 0 200px 60px #ffd34a55;animation:gentle 8s ease-in-out infinite;pointer-events:none}
    .moon{position:absolute;width:140px;height:140px;border-radius:50%;right:9vw;top:9vh;background:radial-gradient(circle at 30% 30%,#fff,#dfe6ff 60%,#a9b7ff 100%);box-shadow:0 0 60px 20px #a9b7ff55,0 0 140px 50px #7f93ff33;animation:gentle 9s ease-in-out infinite;filter:drop-shadow(0 8px 18px #0006);pointer-events:none;display:none}
    .stars,.stars:before,.stars:after{position:absolute;inset:0;content:"";display:none}
    .stars{width:2px;height:2px;box-shadow:10vw 4vh #fff,15vw 18vh #fff,28vw 10vh #fff,35vw 22vh #fff,42vw 8vh #fff,55vw 16vh #fff,62vw 5vh #fff,71vw 13vh #fff,78vw 3vh #fff,86vw 20vh #fff,92vw 6vh #fff,5vw 28vh #fff,18vw 34vh #fff,26vw 42vh #fff,39vw 38vh #fff,47vw 30vh #fff,59vw 44vh #fff,73vw 36vh #fff,81vw 32vh #fff,90vw 40vh #fff,8vw 52vh #fff,22vw 60vh #fff,31vw 55vh #fff,44vw 62vh #fff,57vw 58vh #fff,66vw 64vh #fff,74vw 51vh #fff,83vw 66vh #fff,93vw 54vh #fff,14vw 72vh #fff,28vw 78vh #fff,36vw 70vh #fff,49vw 80vh #fff,58vw 74vh #fff,69vw 86vh #fff,77vw 76vh #fff,88vw 90vh #fff,96vw 82vh #fff;animation:twinkle 3.2s infinite ease-in-out alternate;opacity:.95}
    .stars:before{width:1px;height:1px;box-shadow:12vw 12vh #fff,24vw 6vh #fff,33vw 18vh #fff,46vw 12vh #fff,60vw 6vh #fff,70vw 22vh #fff,82vw 16vh #fff,95vw 10vh #fff,5vw 18vh #fff,17vw 26vh #fff,29vw 32vh #fff,41vw 28vh #fff,53vw 36vh #fff,67vw 30vh #fff,79vw 26vh #fff,91vw 34vh #fff,9vw 50vh #fff,21vw 46vh #fff,33vw 54vh #fff,45vw 48vh #fff,57vw 52vh #fff,69vw 46vh #fff,81vw 58vh #fff,93vw 50vh #fff,7vw 76vh #fff,19vw 70vh #fff,31vw 82vh #fff,43vw 74vh #fff,55vw 86vh #fff,67vw 78vh #fff,79vw 90vh #fff,91vw 82vh #fff}
    .stars:after{width:3px;height:3px;box-shadow:8vw 8vh #fff,20vw 14vh #fff,32vw 6vh #fff,44vw 16vh #fff,56vw 10vh #fff,68vw 18vh #fff,80vw 12vh #fff,92vw 4vh #fff,4vw 40vh #fff,16vw 44vh #fff,28vw 36vh #fff,40vw 46vh #fff,52vw 40vh #fff,64vw 48vh #fff,76vw 42vh #fff,88vw 50vh #fff,12vw 68vh #fff,24vw 62vh #fff,36vw 72vh #fff,48vw 64vh #fff,60vw 76vh #fff,72vw 68vh #fff,84vw 80vh #fff,96vw 72vh #fff}
    .sky.day{background:linear-gradient(180deg,#bde3ff 0%,#EAF5FF 70%,#fff 100%);animation:sunrise 16s ease-in-out infinite alternate}
    .sky.night{background:radial-gradient(1200px 600px at 50% 120%,#00122a,#020817 60%);animation:nightPulse 12s ease-in-out infinite alternate}

    .theme-toggle{position:fixed;right:18px;top:18px;z-index:5;border:0;border-radius:1000px;padding:10px 14px;display:inline-flex;align-items:center;gap:10px;background:#ffffffcc;color:#222;backdrop-filter:blur(10px);box-shadow:0 10px 24px #00000022,inset 0 1px 0 #ffffffcc;font-weight:700}

    .wrap{min-height:100%;display:grid;grid-template-columns:1.2fr 1fr;gap:28px;padding:clamp(16px,3vw,32px);position:relative;z-index:0}
    @media (max-width:980px){.wrap{grid-template-columns:1fr}.hero{order:2}.card{order:1}}

    .hero{position:relative;border-radius:var(--radius-2xl);overflow:hidden;background:
      radial-gradient(600px 300px at 30% 25%, rgba(39,174,96,.20), transparent 70%),
      linear-gradient(160deg, rgba(13, 80, 138, .75), rgba(9, 48, 84, .85));
      box-shadow:var(--shadow-lg);display:grid;place-items:center;padding:clamp(16px,4vw,48px);isolation:isolate;text-align:center;color:#fff}
    body.theme-light .hero{background:linear-gradient(160deg,rgba(255,255,255,.85),rgba(255,255,255,.75));color:var(--fg)}

    .badge-row{position:absolute;top:16px;left:16px;right:16px;display:flex;gap:10px;flex-wrap:wrap;opacity:.95}
    .badge{background:rgba(255,255,255,.12);border:1px dashed rgba(255,255,255,.35);padding:6px 10px;border-radius:999px;font-size:12px;display:inline-flex;align-items:center;gap:6px;backdrop-filter:blur(4px);color:#fff}
    body.theme-light .badge{background:#f3f7ff;border-color:#d7e7ff;color:var(--fg)}

    .title{font-family:"Poppins",system-ui; font-weight:800; letter-spacing:.4px; font-size:clamp(28px,4.2vw,52px); margin:0 0 8px}
    .subtitle{margin:0 auto 12px;font-size:clamp(14px,1.2vw,18px);color:var(--subtitle-fg);max-width:46ch}

    .mascot{width:clamp(220px,36vw,420px);filter:drop-shadow(0 10px 24px rgba(0,0,0,.35));animation:floaty 6s ease-in-out infinite}
    @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    .ear{transform-origin:60% 40%;animation:earwiggle 3.6s ease-in-out infinite}
    @keyframes earwiggle{0%,100%{transform:rotate(0)}50%{transform:rotate(-6deg)}}
    .eye{animation:blink 5s infinite;transform-origin:center}
    @keyframes blink{0%,92%,100%{transform:scaleY(1)}96%{transform:scaleY(.1)}}

    .card{align-self:center;background:var(--panel);border:1px solid var(--panel-border);border-radius:var(--radius-2xl);box-shadow:var(--shadow-lg);padding:clamp(18px,3vw,32px);backdrop-filter:blur(6px);color:var(--fg)}

    .brand{display:flex;align-items:center;gap:10px;margin-bottom:8px}
    .logo{width:40px;height:40px;border-radius:10px;background:conic-gradient(from 210deg, var(--nv-yellow-500), var(--nv-green-600), var(--nv-blue-600), var(--nv-yellow-500));box-shadow:inset 0 0 0 3px rgba(255,255,255,.25),0 6px 16px rgba(0,0,0,.25)}
    .brand h1{font-family:"Poppins",system-ui;font-size:22px;margin:0}

    .tabs{display:flex;gap:8px;margin:12px 0 16px}
    .tab{flex:1;text-align:center;padding:10px;border-radius:12px;border:1px solid var(--tab-border);background:var(--tab-bg);cursor:pointer;font-weight:800;color:var(--fg)}
    .tab.active{background:linear-gradient(180deg,#F4B400,#D99C00);color:#1A1A1A;border:0}

    .field{display:grid;gap:6px;margin-bottom:12px}
    label{font-size:13px;opacity:.9;color:var(--fg)}
    .input,select{width:100%;padding:12px 14px;border-radius:14px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--fg);outline:none;transition:border .2s, box-shadow .2s}
    .input::placeholder{color:color-mix(in srgb, var(--fg) 60%, transparent)}
    select{appearance:none}
    .input:focus,select:focus{border-color:var(--nv-blue-600);box-shadow:0 0 0 4px rgba(45,156,219,.18)}

    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;width:100%;border:none;cursor:pointer;border-radius:14px;font-weight:800;padding:12px 16px;background:linear-gradient(180deg,#F4B400,#D99C00);color:#1A1A1A;box-shadow:0 10px 18px rgba(244,180,0,.25)}
    .hint{font-size:12px;color:var(--muted-fg)}

    @media (prefers-reduced-motion:reduce){.mascot,.ear,.eye,.sun,.moon,.stars{animation:none !important}}
    @keyframes sunrise{0%{background:linear-gradient(180deg,#76c8ff 0%,#bde3ff 40%,#ffffff 85%)}100%{background:linear-gradient(180deg,#ffd1a1 0%,#ffe7c2 40%,#ffffff 85%)}}
    @keyframes nightPulse{0%{filter:brightness(1)}100%{filter:brightness(1.15)}}
    @keyframes twinkle{from{opacity:.65;transform:translateY(0)}to{opacity:1;transform:translateY(-1px)}}
    @keyframes gentle{0%{transform:translateY(0) rotate(-2deg) scale(1)}50%{transform:translateY(4px) rotate(2deg) scale(1.02)}100%{transform:translateY(0) rotate(-2deg) scale(1)}}
    /* ---------- CTA Card + Progress + Button ---------- */
.cta-card{
  position: relative;
  padding: 16px;
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border: 1px solid rgba(255,255,255,.14);
  box-shadow: 0 10px 28px rgba(0,0,0,.22);
  max-width: 420px;
  margin-top: 20px;
}

.corner{
  position:absolute;
  right:10px; bottom:10px;
  width:16px; height:16px;
  border-radius:6px;
  background:#FF6B6B;
  filter: drop-shadow(0 6px 12px rgba(255,107,107,.35));
}

.progress{
  --track:#1b2636;
  --glow: rgba(255,107,107,.35);
  height: 10px;
  width: 100%;
  background: linear-gradient(180deg, var(--track), #0f1724);
  border-radius: 999px;
  overflow: hidden;
  position: relative;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
  margin-bottom: 14px;
}

.progress > span{
  --pct: 0%;
  display:block;
  height:100%;
  width: var(--pct);
  background: linear-gradient(90deg,#ffb3b3,#FF6B6B);
  position:relative;
  transition: width .35s ease;
  box-shadow: 0 0 0 1px rgba(255,255,255,.06), 0 6px 16px var(--glow);
}

.progress > span::after{
  content:"";
  position:absolute;
  top:0; bottom:0; width:60px;
  left:-80px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
  filter: blur(2px);
  opacity:.55;
  animation: sheen 2.8s linear infinite;
}

@keyframes sheen{
  to { transform: translateX(220%); }
}

.button{
  --bg1:#ffb86b; --bg2:#FF6B6B; --ring: rgba(255,107,107,.45);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  width:100%;
  padding: 12px 16px;
  text-decoration:none;
  cursor:pointer;
  user-select:none;
  border:0;
  border-radius:14px;
  font: 800 16px/1.2 system-ui, -apple-system, Segoe UI, Roboto, "Nunito", Arial, sans-serif;
  color:#1A1A1A;
  background: linear-gradient(180deg, var(--bg1), var(--bg2));
  box-shadow: 0 10px 18px rgba(255,107,107,.25), inset 0 -3px 0 rgba(0,0,0,.12);
  transition: transform .08s ease, filter .2s ease, box-shadow .2s ease;
  position: relative;
  overflow: hidden;
}

.button.primary::before{
  content:"";
  position:absolute;
  inset:0;
  background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,.35) 40%, transparent 60%);
  transform: translateX(-120%);
  transition: transform .6s ease;
  pointer-events:none;
}

.button.primary:hover::before{
  transform: translateX(0%);
}

.button:hover{
  filter: brightness(1.05);
}

.button:active{
  transform: translateY(1px);
  box-shadow: 0 6px 12px rgba(255,107,107,.25), inset 0 -2px 0 rgba(0,0,0,.16);
}

.button:focus-visible{
  outline:none;
  box-shadow:
    0 0 0 4px var(--ring),
    0 10px 18px rgba(255,107,107,.25),
    inset 0 -3px 0 rgba(0,0,0,.12);
}

.cta{ margin-top:10px; }

  </style>
</head>
<body class="theme-dark">
  <!-- Sky -->
  <div id="sky" class="sky night" aria-hidden="true"></div>
  <div class="sun" aria-hidden="true"></div>
  <div class="moon" aria-hidden="true"></div>
  <div class="stars" aria-hidden="true"></div>

  <!-- Theme Toggle -->
  <button id="themeToggle" class="theme-toggle" aria-pressed="false" aria-label="Toggle color theme">üåô Dark</button>

  <div class="wrap" role="main">
    <!-- LEFT: Panda hero (kept) -->
    <section class="hero" aria-label="NeoVidya playful welcome">
      <div class="badge-row" aria-hidden="true">
        <div class="badge">‚≠ê Level Up</div>
        <div class="badge">üåø Grow Skills</div>
        <div class="badge">üõ° Safe Space</div>
      </div>
      <div class="hero-copy">
        <h2 class="title">Create your NeoVidya account</h2>
        <p class="subtitle">Pick your role and fill the form. Teachers use the code shared by your school.</p>

        <!-- Panda -->
        <svg class="mascot" viewBox="0 0 320 260" role="img" aria-label="Playful panda mascot chewing bamboo">
          <defs>
            <radialGradient id="pandaFur" cx="50%" cy="35%" r="70%"><stop offset="0%" stop-color="#FFFFFF"/><stop offset="100%" stop-color="#EDEDED"/></radialGradient>
            <linearGradient id="bambooGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#A6E17B"/><stop offset="100%" stop-color="#3BAE5B"/></linearGradient>
            <linearGradient id="bambooLeaf" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#8EE089"/><stop offset="100%" stop-color="#2DAE56"/></linearGradient>
          </defs>
          <ellipse cx="160" cy="235" rx="90" ry="14" fill="#000" opacity=".22"/>
          <ellipse cx="150" cy="165" rx="82" ry="62" fill="url(#pandaFur)"/>
          <ellipse cx="105" cy="165" rx="32" ry="26" fill="#1C1C1C"/>
          <ellipse cx="195" cy="165" rx="32" ry="26" fill="#1C1C1C"/>
          <g transform="translate(95,60)">
            <g class="ear"><circle cx="18" cy="18" r="18" fill="#1C1C1C"/><circle cx="118" cy="16" r="18" fill="#1C1C1C"/></g>
            <circle cx="68" cy="56" r="56" fill="url(#pandaFur)"/>
            <ellipse cx="48" cy="56" rx="16" ry="20" fill="#1C1C1C"/><ellipse cx="88" cy="56" rx="16" ry="20" fill="#1C1C1C"/>
            <g class="eye"><circle cx="48" cy="58" r="6" fill="#0C1220"/><circle cx="88" cy="58" r="6" fill="#0C1220"/></g>
            <circle cx="46" cy="56" r="2" fill="#fff"/><circle cx="86" cy="56" r="2" fill="#fff"/>
            <ellipse cx="68" cy="72" rx="8" ry="6" fill="#1C1C1C"/><path d="M60 78q8 8 16 0" stroke="#1C1C1C" stroke-width="3" fill="none" stroke-linecap="round"/>
            <circle cx="36" cy="74" r="6" fill="#FF9DB2" opacity=".9"/><circle cx="100" cy="74" r="6" fill="#FF9DB2" opacity=".9"/>
          </g>
          <ellipse cx="115" cy="210" rx="24" ry="20" fill="#1C1C1C"/><ellipse cx="185" cy="210" rx="24" ry="20" fill="#1C1C1C"/>
          <g transform="translate(170,150)">
            <g style="transform-origin:0 0;animation:chew 1.8s ease-in-out infinite;">
              <rect x="0" y="-6" width="80" height="12" rx="6" fill="url(#bambooGrad)"/>
              <rect x="24" y="-7" width="2" height="14" fill="#2E8B57" opacity=".6"/><rect x="48" y="-7" width="2" height="14" fill="#2E8B57" opacity=".6"/>
              <path d="M12 -14 C 20 -18, 30 -16, 36 -8 C 28 -8, 20 -10, 12 -14" fill="url(#bambooLeaf)"/>
              <path d="M8 10 C 18 14, 28 16, 36 10 C 26 10, 18 8, 8 10" fill="url(#bambooLeaf)"/>
            </g>
          </g>
        </svg>
        <style>
          @keyframes chew{0%,100%{transform:rotate(-4deg) translateY(0)}50%{transform:rotate(6deg) translateY(2px)}}
        </style>
      </div>
    </section>

    <!-- RIGHT: Sign-up form -->
    <section class="card" aria-label="Create account">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>NeoVidya</h1>
          <div style="font-size:12px;color:var(--muted-fg)">Create your account</div>
        </div>
      </div>

      <!-- Role tabs only (no login/signup toggle) -->
      <div class="tabs" role="tablist" aria-label="Choose role">
        <button class="tab active" id="tabStudent" role="tab" aria-selected="true">Student</button>
        <button class="tab" id="tabTeacher" role="tab" aria-selected="false">Teacher</button>
      </div>

      <form id="signupForm" novalidate>
        <!-- Common fields -->
        <div class="field">
          <label for="name">Full name</label>
          <input id="name" class="input" type="text" placeholder="e.g., Asha Verma" autocomplete="name" required/>
        </div>
        <div class="field">
          <label for="school">School name</label>
          <input id="school" class="input" type="text" placeholder="e.g., Sarvodaya Vidyalaya" autocomplete="organization" required/>
          <div class="hint">Tip: type exact school name shared by your school.</div>
        </div>
        <div class="field">
          <label for="email">Gmail</label>
          <input id="email" class="input" type="email" placeholder="yourname@gmail.com" autocomplete="email" required/>
        </div>
       

        <!-- Student-only -->
        <div id="groupGrade" class="field">
          <label for="grade">Grade</label>
          <select id="grade" required>
            <option value="">Select grade</option>
            <option>Class 1</option><option>Class 2</option><option>Class 3</option><option>Class 4</option><option>Class 5</option>
            <option>Class 6</option><option>Class 7</option><option>Class 8</option><option>Class 9</option><option>Class 10</option>
          </select>
        </div>

        <!-- Teacher-only -->
        <div id="groupTeacher" style="display:none">
          <div class="field">
            <label for="tcode">Teacher code (required)</label>
            <input id="tcode" class="input" type="text" placeholder="Enter code given by your school"/>
            <div class="hint">Your school admin shares this code. It must match the selected school.</div>
          </div>
        </div>
         <!-- Stylish CTA section -->
<div class="cta-card">
  <!-- Progress Bar -->
  <div class="progress" aria-label="Signup progress">
    <span style="--pct: 0%"></span> <!-- you can change --pct value dynamically -->
  </div>

  <!-- Button -->
  <div class="cta">
    <a class="button primary" href="dash1.html" data-subject="Create an account">
      <span>Create an account</span>
    </a>
  </div>

  <!-- Decorative corner -->
  <div class="corner"></div>
</div>

      </form>
    </section>
  </div>

  <script>
  (function(){
    /* ---------- Theme toggle ---------- */
    const body=document.body, sky=document.getElementById('sky'), tbtn=document.getElementById('themeToggle');
    const sun=document.querySelector('.sun');
    const moon=document.querySelector('.moon');
    const stars=document.querySelector('.stars');

    const saved=localStorage.getItem('nv-theme')||'dark';
    setTheme(saved);

    tbtn.addEventListener('click',()=>setTheme(body.classList.contains('theme-dark')?'light':'dark'));

    function setTheme(mode){
      const dark=(mode==='dark');
      body.classList.toggle('theme-dark',dark);
      body.classList.toggle('theme-light',!dark);
      sky.classList.toggle('night',dark); sky.classList.toggle('day',!dark);
      sun.style.display = dark ? 'none' : 'block';
      moon.style.display = dark ? 'block' : 'none';
      stars.style.display = dark ? 'block' : 'none';
      tbtn.textContent = dark ? 'üåô Dark' : '‚òÄ Light';
      tbtn.setAttribute('aria-pressed', String(dark));
      localStorage.setItem('nv-theme',mode);
      // Also update meta theme-color for mobile browser UI
      const meta = document.querySelector('meta[name="theme-color"]');
      if(meta) meta.setAttribute('content', dark ? '#020817' : '#EAF5FF');
    }

    /* ---------- Elements ---------- */
    const tabStudent=document.getElementById('tabStudent');
    const tabTeacher=document.getElementById('tabTeacher');
    const groupGrade=document.getElementById('groupGrade');
    const groupTeacher=document.getElementById('groupTeacher');

    const form=document.getElementById('signupForm');
    const nameEl=document.getElementById('name');
    const schoolEl=document.getElementById('school');
    const emailEl=document.getElementById('email');
    const passEl=document.getElementById('password');
    const gradeEl=document.getElementById('grade');
    const tcodeEl=document.getElementById('tcode');

    let role='student';
    setRole('student');
    tabStudent.addEventListener('click',()=>setRole('student'));
    tabTeacher.addEventListener('click',()=>setRole('teacher'));

    function setRole(r){
      role=r;
      tabStudent.classList.toggle('active', role==='student');
      tabTeacher.classList.toggle('active', role==='teacher');
      groupGrade.style.display = role==='student' ? '' : 'none';
      if(groupGrade.querySelector('select')){
        groupGrade.querySelector('select').required = (role==='student');
      }
      groupTeacher.style.display = role==='teacher' ? '' : 'none';
    }

    /* ---------- School registry (demo offline) ----------
       Structure: { "School Name": ["CODE1","CODE2"], ... }
       In production: validate server-side via API.
    ----------------------------------------------------- */
    const REGISTRY_KEY = 'nv-school-registry';
    const SCHOOL_REGISTRY_SEED = {
      "Sarvodaya Vidyalaya": ["SV-TEACH-2025", "SV-IT-01"],
      "Green Valley Public School": ["GVPS-STAFF-9X", "GVPS-SCI-7A"],
      "Shishu Mandir": ["SM-2025-TCHR"],
      "Model Government School": ["MGS-TEACH-101"]
    };
    function seedSchoolRegistry(){
      if(!localStorage.getItem(REGISTRY_KEY)){
        localStorage.setItem(REGISTRY_KEY, JSON.stringify(SCHOOL_REGISTRY_SEED));
      }
    }
    function getRegistry(){
      try{ return JSON.parse(localStorage.getItem(REGISTRY_KEY) || '{}'); }
      catch(e){ return {}; }
    }
    seedSchoolRegistry();

    // helper: basic users store (offline)
    function users(){ try{return JSON.parse(localStorage.getItem('nv-users')||'{}')}catch(e){return {}} }
    function saveUsers(m){ localStorage.setItem('nv-users', JSON.stringify(m)); }
    function key(role,email){ return role + '|' + (email||'').toLowerCase(); }

    // where to redirect post signup
    const ROUTES = {
      student: 'student-dashboard.html',
      teacher: 'teacher-dashboard.html'
    };

    /* ---------- Form submit (Sign-up only) ---------- */
    form.addEventListener('submit', (e)=>{
      e.preventDefault();

      // Common validation
      const name = nameEl.value.trim();
      const school = schoolEl.value.trim();
      const email = (emailEl.value||'').trim();
      const pass = passEl.value;

      if(!name) return alert('Please enter your full name.');
      if(!school) return alert('Please enter your school name.');
      if(!email) return alert('Please enter your Gmail.');
      if(!/^[^@\s]+@gmail\.com$/i.test(email)) return alert('Please enter a valid Gmail address.');
      if(!pass) return alert('Please create a password.');

      // Role-specific
      let extra = {};
      if(role==='student'){
        const grade = gradeEl.value;
        if(!grade) return alert('Please select your grade.');
        extra.grade = grade;
      } else {
        const code = (tcodeEl?.value||'').trim();
        if(!code) return alert('Please enter the teacher code provided by your school.');
        // Validate teacher code against selected school (case-insensitive match of name)
        const reg = getRegistry();
        const schoolKey = Object.keys(reg).find(k => k.toLowerCase() === school.toLowerCase());
        if(!schoolKey) return alert('This school is not in the registry.\nAsk your admin to add it or check the spelling.');
        const ok = (reg[schoolKey] || []).some(c => c.toLowerCase() === code.toLowerCase());
        if(!ok) return alert('Invalid teacher code for the selected school.');
        extra.tcode = code;
      }

      // Save account (offline)
      const map = users();
      const k = key(role, email);
      if(map[k]) return alert('Account already exists for this Gmail and role.');
      map[k] = { role, name, school, email, pass, ...extra, createdAt: Date.now() };
      saveUsers(map);
      sessionStorage.setItem('nv_toast','Check the email for the username and password');
      window.location.replace('dash1.html');

      // cache session data for dashboards
      localStorage.setItem('nv-role', role);
      localStorage.setItem('nv-name', name);
      localStorage.setItem('nv-school', school);
      localStorage.setItem('nv-email', email);
      if(role==='student') localStorage.setItem('nv-grade', extra.grade||'');

      alert('Account created! Redirecting‚Ä¶');
      window.location.replace(ROUTES[role] || 'index.html');
    });

    /* ---------- Optional: admin helper in console ---------- */
    window.addTeacherCode = function(schoolName, code){
      const reg = getRegistry();
      const key = Object.keys(reg).find(k=>k.toLowerCase()===schoolName.toLowerCase()) || schoolName;
      if(!reg[key]) reg[key] = [];
      if(!reg[key].includes(code)) reg[key].push(code);
      localStorage.setItem(REGISTRY_KEY, JSON.stringify(reg));
      return reg[key];
    };
    window.addSchool = function(schoolName, codes){
      const reg = getRegistry();
      reg[schoolName] = Array.isArray(codes) ? codes : [];
      localStorage.setItem(REGISTRY_KEY, JSON.stringify(reg));
      return reg[schoolName];
    };
    window.listSchoolCodes = function(schoolName){
      const reg = getRegistry();
      const key = Object.keys(reg).find(k=>k.toLowerCase()===schoolName.toLowerCase());
      return key ? reg[key] : [];
    };
  })();
  </script>
</body>
</html>
